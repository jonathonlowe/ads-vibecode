import { withLazyLoading } from '@atlaskit/editor-common/lazy-node-view';
import { fg } from '@atlaskit/platform-feature-flags';
import { editorExperiment } from '@atlaskit/tmp-editor-statsig/experiments';
import { ReactMediaNode } from './mediaNodeView';
export const lazyMediaView = (portalProviderAPI, eventDispatcher, providerFactory, options = {}, api) => {
  if (fg('platform_editor_ssr_media') || editorExperiment('platform_editor_exp_lazy_node_views', false)) {
    return ReactMediaNode(portalProviderAPI, eventDispatcher, providerFactory, options, api);
  }
  return withLazyLoading({
    nodeName: 'media',
    getNodeViewOptions: () => {},
    loader: () => {
      const result = import( /* webpackChunkName: "@atlaskit-internal_editor-plugin-media-lazy-node-view" */
      './mediaNodeView').then(({
        ReactMediaNode
      }) => {
        return (node, view, getPos) => {
          return ReactMediaNode(portalProviderAPI, eventDispatcher, providerFactory, options, api)(node, view, getPos);
        };
      });
      return result;
    }
  });
};