"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.extractPreview = void 0;
var _extractPlatformIsSupported = require("../platform/extractPlatformIsSupported");
var _url = require("../url");
/**
 * @deprecated Please use extractEmbed instead
 */
var extractPreview = exports.extractPreview = function extractPreview(jsonLd, platform, iframeUrlType) {
  var preview = jsonLd === null || jsonLd === void 0 ? void 0 : jsonLd.preview;
  var isSupported = (0, _extractPlatformIsSupported.extractPlatformIsSupported)(preview, platform);
  if (preview && isSupported) {
    if (typeof preview === 'string') {
      return {
        src: preview
      };
    } else if (preview['@type'] === 'Link' && iframeUrlType === 'interactiveHref' && preview.interactiveHref) {
      return {
        src: preview.interactiveHref,
        aspectRatio: preview['atlassian:aspectRatio']
      };
    } else if (preview['@type'] === 'Link') {
      return {
        src: (0, _url.extractUrlFromLinkJsonLd)(preview),
        aspectRatio: preview['atlassian:aspectRatio']
      };
    } else {
      // TODO, EDM-565: Remove this once the typings for Dropbox and Jira have been patched up.
      if (preview.url || preview.href) {
        if (iframeUrlType === 'interactiveHref' && preview.interactiveHref) {
          return {
            src: preview.interactiveHref,
            aspectRatio: preview['atlassian:aspectRatio']
          };
        }
        return {
          src: (0, _url.extractUrlFromLinkJsonLd)(preview.url || preview.href),
          aspectRatio: preview['atlassian:aspectRatio']
        };
      } else if (preview.content) {
        return {
          content: preview.content
        };
      }
    }
  }
};