"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var difference_in_calendar_days_1 = tslib_1.__importDefault(require("date-fns/difference_in_calendar_days"));
var is_before_1 = tslib_1.__importDefault(require("date-fns/is_before"));
var FORMATS;
(function (FORMATS) {
    FORMATS["ISO_FORMAT"] = "YYYY-MM-DD";
    FORMATS["CURRENT_YEAR_FORMAT_WITHOUT_YEAR"] = "CURRENT_YEAR_FORMAT_WITHOUT_YEAR";
    FORMATS["LOCALIZED_FORMAT"] = "LOCALIZED_FORMAT";
})(FORMATS || (FORMATS = {}));
exports.timestampToUTCDate = function (timestamp) {
    var date = new Date(Number(timestamp));
    var day = date.getUTCDate();
    var month = date.getUTCMonth() + 1;
    var year = date.getUTCFullYear();
    return { day: day, month: month, year: year };
};
exports.todayTimestampInUTC = function () {
    var today = new Date(Date.now());
    var todayInUTC = Date.UTC(today.getFullYear(), today.getMonth(), today.getDate());
    return todayInUTC.toString();
};
var addLeadingZero = function (val) {
    if (val < 10) {
        return "0" + val;
    }
    return val;
};
var capitalizeFirstLetter = function (str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
};
// example: "23 Jan 2018"
exports.timestampToString = function (timestamp, intl, pattern) {
    if (!intl || pattern === FORMATS.ISO_FORMAT) {
        return exports.timestampToIsoFormat(timestamp);
    }
    var date = new Date(Number(timestamp));
    var showWeekday = pattern === FORMATS.CURRENT_YEAR_FORMAT_WITHOUT_YEAR;
    var showYear = !showWeekday;
    return intl.formatDate(date, {
        timeZone: 'UTC',
        weekday: showWeekday ? 'short' : undefined,
        month: 'short',
        day: 'numeric',
        year: showYear ? 'numeric' : undefined,
        formatMatcher: 'best fit',
    });
};
// example: "2018-01-23"
exports.timestampToIsoFormat = function (timestamp) {
    var date = new Date(Number(timestamp));
    return date.getUTCFullYear() + "-" + addLeadingZero(date.getUTCMonth() + 1) + "-" + date.getUTCDate();
};
exports.isPastDate = function (timestamp) {
    return is_before_1.default(exports.timestampToIsoFormat(Number(timestamp)), exports.timestampToIsoFormat(new Date().valueOf()));
};
exports.timestampToTaskContext = function (timestamp, intl) {
    var curDate = new Date(Number(exports.todayTimestampInUTC()));
    var givenDate = new Date(Number(timestamp));
    var distance = difference_in_calendar_days_1.default(givenDate, curDate);
    var sameYear = givenDate.getUTCFullYear() === curDate.getUTCFullYear();
    if (intl && [-1, 0, 1].indexOf(distance) > -1) {
        return capitalizeFirstLetter(intl.formatRelative(givenDate, {
            units: 'day',
        }));
    }
    return exports.timestampToString(timestamp, intl, sameYear
        ? FORMATS.CURRENT_YEAR_FORMAT_WITHOUT_YEAR
        : FORMATS.LOCALIZED_FORMAT);
};
//# sourceMappingURL=date.js.map