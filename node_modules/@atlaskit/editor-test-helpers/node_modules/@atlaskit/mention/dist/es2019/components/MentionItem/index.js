import Avatar from '@atlaskit/avatar';
import LockCircleIcon from '@atlaskit/icon/glyph/lock-circle';
import Lozenge from '@atlaskit/lozenge';
import { colors } from '@atlaskit/theme';
import React from 'react';
import { isRestricted, } from '../../types';
import { NoAccessLabel } from '../../util/i18n';
import { leftClick } from '../../util/mouse';
import { NoAccessTooltip } from '../NoAccessTooltip';
import { AccessSectionStyle, AvatarStyle, FullNameStyle, InfoSectionStyle, MentionItemStyle, NameSectionStyle, RowStyle, TimeStyle, } from './styles';
import { renderHighlight } from './MentionHighlightHelpers';
import MentionDescriptionByline from '../MentionDescriptionByline';
function renderLozenge(lozenge) {
    if (lozenge) {
        return React.createElement(Lozenge, null, lozenge);
    }
    return null;
}
function renderTime(time) {
    if (time) {
        return React.createElement(TimeStyle, null, time);
    }
    return null;
}
export default class MentionItem extends React.PureComponent {
    constructor() {
        super(...arguments);
        // internal, used for callbacks
        this.onMentionSelected = (event) => {
            if (leftClick(event) && this.props.onSelection) {
                event.preventDefault();
                this.props.onSelection(this.props.mention, event);
            }
        };
        this.onMentionMenuItemMouseMove = (event) => {
            if (this.props.onMouseMove) {
                this.props.onMouseMove(this.props.mention, event);
            }
        };
        this.onMentionMenuItemMouseEnter = (event) => {
            if (this.props.onMouseEnter) {
                this.props.onMouseEnter(this.props.mention, event);
            }
        };
    }
    render() {
        const { mention, selected } = this.props;
        const { id, highlight, avatarUrl, presence, name, mentionName, lozenge, accessLevel, } = mention;
        const { status, time } = presence || {};
        const restricted = isRestricted(accessLevel);
        const nameHighlights = highlight && highlight.name;
        const borderColor = selected ? colors.N30 : undefined;
        return (React.createElement(MentionItemStyle, { selected: selected, onMouseDown: this.onMentionSelected, onMouseMove: this.onMentionMenuItemMouseMove, onMouseEnter: this.onMentionMenuItemMouseEnter, "data-mention-id": id, "data-mention-name": mentionName },
            React.createElement(RowStyle, null,
                React.createElement(AvatarStyle, { restricted: restricted },
                    React.createElement(Avatar, { src: avatarUrl, size: "medium", presence: status, borderColor: borderColor })),
                React.createElement(NameSectionStyle, { restricted: restricted },
                    renderHighlight(FullNameStyle, name, nameHighlights),
                    React.createElement(MentionDescriptionByline, { mention: mention })),
                React.createElement(InfoSectionStyle, { restricted: restricted },
                    renderLozenge(lozenge),
                    renderTime(time)),
                restricted ? (React.createElement(NoAccessTooltip, { name: name },
                    React.createElement(AccessSectionStyle, null,
                        React.createElement(NoAccessLabel, null, text => (React.createElement(LockCircleIcon, { label: text })) /* safe to cast to string given there is no value binding */)))) : null)));
    }
}
//# sourceMappingURL=index.js.map