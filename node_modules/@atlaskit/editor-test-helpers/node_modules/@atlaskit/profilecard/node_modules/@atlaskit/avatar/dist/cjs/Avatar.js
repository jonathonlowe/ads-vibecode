"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
/** @jsx jsx */
var react_1 = require("react");
var core_1 = require("@emotion/core");
var analytics_next_1 = require("@atlaskit/analytics-next");
var colors_1 = require("@atlaskit/theme/colors");
var AvatarImage_1 = tslib_1.__importDefault(require("./AvatarImage"));
var constants_1 = require("./constants");
var Presence_1 = require("./Presence");
var Status_1 = require("./Status");
var utilities_1 = require("./utilities");
var version_json_1 = require("./version.json");
var Avatar = function (_a) {
    var _b = _a.appearance, appearance = _b === void 0 ? 'circle' : _b, borderColor = _a.borderColor, component = _a.component, href = _a.href, isDisabled = _a.isDisabled, name = _a.name, onClick = _a.onClick, presence = _a.presence, _c = _a.size, size = _c === void 0 ? 'medium' : _c, src = _a.src, stackIndex = _a.stackIndex, status = _a.status, target = _a.target, testId = _a.testId;
    var createAnalyticsEvent = analytics_next_1.useAnalyticsEvents().createAnalyticsEvent;
    var avatarSize = constants_1.AVATAR_SIZES[size];
    var avatarRadius = constants_1.AVATAR_RADIUS[size];
    var customPresenceNode = typeof presence === 'object' ? presence : null;
    var customStatusNode = typeof status === 'object' ? status : null;
    var isValidIconSize = size !== 'xxlarge' && size !== 'xsmall';
    var guardedClick = react_1.useCallback(function (event) {
        if (isDisabled || typeof onClick !== 'function')
            return;
        var analyticsEvent = createAnalyticsEvent({
            action: 'clicked',
            actionSubject: 'avatar',
            attributes: {
                componentName: 'avatar',
                packageName: version_json_1.name,
                packageVersion: version_json_1.version,
            },
        });
        onClick(event, analyticsEvent);
        analyticsEvent.fire('atlaskit');
    }, [createAnalyticsEvent, isDisabled, onClick]);
    var Element = component || utilities_1.getCustomElement(href, onClick);
    return (core_1.jsx("div", { "data-testid": testId, style: {
            display: 'inline-block',
            position: 'relative',
            outline: 0,
            zIndex: stackIndex,
            height: avatarSize + 4 + "px",
            width: avatarSize + 4 + "px",
        } },
        core_1.jsx(Element, tslib_1.__assign({ css: core_1.css(templateObject_1 || (templateObject_1 = tslib_1.__makeTemplateObject(["\n            height: ", "px;\n            width: ", "px;\n            align-items: stretch;\n            background-color: ", ";\n            border: 0;\n            border-radius: ", ";\n            padding: ", "px;\n            box-sizing: content-box;\n            cursor: inherit;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            outline: none;\n            overflow: hidden;\n            position: static;\n            transform: translateZ(0);\n            transition: opacity 200ms, background-color 200ms ease-out;\n\n            &::-moz-focus-inner {\n              border: 0;\n              margin: 0;\n              padding: 0;\n            }\n\n            &::after {\n              background-color: transparent;\n              border-radius: ", ";\n              bottom: ", "px;\n              content: ' ';\n              left: ", "px;\n              opacity: 0;\n              pointer-events: none;\n              position: absolute;\n              right: ", "px;\n              top: ", "px;\n              transition: opacity 200ms;\n            }\n            ", "\n\n            ", "\n\n            ", "\n          "], ["\n            height: ", "px;\n            width: ", "px;\n            align-items: stretch;\n            background-color: ", ";\n            border: 0;\n            border-radius: ",
                ";\n            padding: ", "px;\n            box-sizing: content-box;\n            cursor: inherit;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            outline: none;\n            overflow: hidden;\n            position: static;\n            transform: translateZ(0);\n            transition: opacity 200ms, background-color 200ms ease-out;\n\n            &::-moz-focus-inner {\n              border: 0;\n              margin: 0;\n              padding: 0;\n            }\n\n            &::after {\n              background-color: transparent;\n              border-radius: ",
                ";\n              bottom: ", "px;\n              content: ' ';\n              left: ", "px;\n              opacity: 0;\n              pointer-events: none;\n              position: absolute;\n              right: ", "px;\n              top: ", "px;\n              transition: opacity 200ms;\n            }\n            ", "\n\n            ",
                "\n\n            ",
                "\n          "])), avatarSize, avatarSize, borderColor || colors_1.background(), appearance === 'circle'
                ? '50%'
                : avatarRadius + constants_1.BORDER_WIDTH + "px", constants_1.BORDER_WIDTH, appearance === 'circle' ? '50%' : avatarRadius + "px", constants_1.BORDER_WIDTH, constants_1.BORDER_WIDTH, constants_1.BORDER_WIDTH, constants_1.BORDER_WIDTH, stackIndex && "position: relative;", Boolean(href || onClick) &&
                "\n              cursor: pointer;\n\n              :focus {\n                outline: none;\n                background-color: " + colors_1.B200 + ";\n              }\n\n              :active,\n              :hover {\n                &::after {\n                  background-color: " + colors_1.N70A + ";\n                  opacity: 1;\n                }\n              }\n\n              :active {\n                transform: scale(0.9);\n              }\n            ", isDisabled &&
                "\n                cursor: not-allowed;\n\n                &::after {\n                  opacity: 1;\n                  pointer-events: none;\n                  background-color: rgba(255, 255, 255, 0.7);\n                }\n              ") }, (href && utilities_1.getLinkProps(href, target)), (!href && onClick && utilities_1.getButtonProps(isDisabled)), (!component
            ? { 'data-testid': testId && testId + "--inner" }
            : { testId: testId && testId + "--inner" }), { onClick: guardedClick }),
            core_1.jsx(AvatarImage_1.default, { alt: name, appearance: appearance, size: size, src: src })),
        isValidIconSize && presence && !status && (core_1.jsx(Presence_1.PresenceWrapper, { appearance: appearance, size: size, presence: !customPresenceNode && presence, testId: testId }, customPresenceNode)),
        isValidIconSize && status && (core_1.jsx(Status_1.StatusWrapper, { appearance: appearance, size: size, borderColor: borderColor, status: !customStatusNode && status, testId: testId }, customStatusNode))));
};
exports.default = Avatar;
var templateObject_1;
//# sourceMappingURL=Avatar.js.map