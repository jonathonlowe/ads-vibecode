"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.startLighthouseObserver = exports.getLighthouseMetrics = void 0;
var _selfMeasurements = require("../../../self-measurements");
var _cls = require("./cls");
var _const = require("./const");
var _tbt = require("./tbt");
var _buffer = require("./utils/buffer");
var _observer = require("./utils/observer");
var startLighthouseObserver = exports.startLighthouseObserver = (0, _selfMeasurements.withProfiling)(function startLighthouseObserver() {
  (0, _observer.startLSObserver)();
  (0, _observer.startLTObserver)();
});
var getLighthouseMetrics = exports.getLighthouseMetrics = (0, _selfMeasurements.withProfiling)(function getLighthouseMetrics(_ref) {
  var start = _ref.start,
    stop = _ref.stop;
  var tbt = (0, _tbt.getTBT)(start, stop, _buffer.EntriesBuffer[_const.PerformanceObserverEntryTypes.LongTask]);

  // no round as CLS is usually 0-1
  var cls = (0, _cls.getCLS)(start, stop, _buffer.EntriesBuffer[_const.PerformanceObserverEntryTypes.LayoutShift]);
  return {
    'metric:tbt': Math.round(tbt.total),
    'metric:tbt:observed': Math.round(tbt.observed),
    'metric:cls': cls
  };
});