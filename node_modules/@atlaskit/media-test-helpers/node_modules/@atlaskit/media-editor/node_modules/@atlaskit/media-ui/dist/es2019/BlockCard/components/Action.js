/** @jsx jsx */
import { jsx } from '@emotion/core';
import { useState } from 'react';
import Button from '@atlaskit/button';
import { ActionIcon } from './ActionIcon';
export const spinnerDelay = 1000;
export const Action = ({ promise, text, buttonAppearance = 'default', id, }) => {
    const [state, setState] = useState('init');
    return (jsx(Button, { spacing: "compact", appearance: buttonAppearance, isLoading: state === 'loading', testId: `button-${id}`, onClick: event => {
            event.stopPropagation();
            event.preventDefault();
            if (state !== 'loading') {
                setState('loading');
                promise()
                    .then(() => {
                    setState('success');
                    setTimeout(() => setState('init'), spinnerDelay);
                })
                    .catch(() => {
                    setState('failure');
                    setTimeout(() => setState('init'), spinnerDelay);
                });
            }
        } },
        jsx("div", { css: {
                transition: 'opacity 0.3s',
                opacity: state !== 'init' ? 0 : 1,
            } }, text),
        jsx(ActionIcon, { state: state })));
};
//# sourceMappingURL=Action.js.map