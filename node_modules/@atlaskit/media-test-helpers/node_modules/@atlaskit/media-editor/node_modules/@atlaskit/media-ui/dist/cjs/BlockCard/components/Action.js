"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
/** @jsx jsx */
var core_1 = require("@emotion/core");
var react_1 = require("react");
var button_1 = tslib_1.__importDefault(require("@atlaskit/button"));
var ActionIcon_1 = require("./ActionIcon");
exports.spinnerDelay = 1000;
exports.Action = function (_a) {
    var promise = _a.promise, text = _a.text, _b = _a.buttonAppearance, buttonAppearance = _b === void 0 ? 'default' : _b, id = _a.id;
    var _c = tslib_1.__read(react_1.useState('init'), 2), state = _c[0], setState = _c[1];
    return (core_1.jsx(button_1.default, { spacing: "compact", appearance: buttonAppearance, isLoading: state === 'loading', testId: "button-" + id, onClick: function (event) {
            event.stopPropagation();
            event.preventDefault();
            if (state !== 'loading') {
                setState('loading');
                promise()
                    .then(function () {
                    setState('success');
                    setTimeout(function () { return setState('init'); }, exports.spinnerDelay);
                })
                    .catch(function () {
                    setState('failure');
                    setTimeout(function () { return setState('init'); }, exports.spinnerDelay);
                });
            }
        } },
        core_1.jsx("div", { css: {
                transition: 'opacity 0.3s',
                opacity: state !== 'init' ? 0 : 1,
            } }, text),
        core_1.jsx(ActionIcon_1.ActionIcon, { state: state })));
};
//# sourceMappingURL=Action.js.map