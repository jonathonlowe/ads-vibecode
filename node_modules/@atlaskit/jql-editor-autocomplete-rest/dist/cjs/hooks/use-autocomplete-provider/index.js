"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useAutocompleteProvider = void 0;
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _react = require("react");
var _analytics = require("../../analytics");
var _state = require("../../state");
var _useOnFields = _interopRequireDefault(require("../use-on-fields"));
var _useOnFunctions = _interopRequireDefault(require("../use-on-functions"));
var _useOnOperators = _interopRequireDefault(require("../use-on-operators"));
var _useOnValues = _interopRequireDefault(require("../use-on-values"));
var useAutocompleteProvider = exports.useAutocompleteProvider = function useAutocompleteProvider(analyticsSource, getInitialData, getSuggestions) {
  var _useJqlEditorAutocomp = (0, _analytics.useJqlEditorAutocompleteAnalytics)(analyticsSource),
    createAndFireAnalyticsEvent = _useJqlEditorAutocomp.createAndFireAnalyticsEvent;
  var _useJqlAutocompleteAc = (0, _state.useJqlAutocompleteActions)(),
    _useJqlAutocompleteAc2 = (0, _slicedToArray2.default)(_useJqlAutocompleteAc, 2),
    load = _useJqlAutocompleteAc2[1].load;
  var _useJqlSearchableFiel = (0, _state.useJqlSearchableFieldsObservable)(),
    _useJqlSearchableFiel2 = (0, _slicedToArray2.default)(_useJqlSearchableFiel, 1),
    jqlSearchableFields$ = _useJqlSearchableFiel2[0];
  var _useJqlOrderableField = (0, _state.useJqlOrderableFieldsObservable)(),
    _useJqlOrderableField2 = (0, _slicedToArray2.default)(_useJqlOrderableField, 1),
    jqlOrderableFields$ = _useJqlOrderableField2[0];
  var _useJqlFunctionsObser = (0, _state.useJqlFunctionsObservable)(),
    _useJqlFunctionsObser2 = (0, _slicedToArray2.default)(_useJqlFunctionsObser, 1),
    jqlFunctions$ = _useJqlFunctionsObser2[0];
  var onFields = (0, _useOnFields.default)(jqlSearchableFields$, jqlOrderableFields$);
  var onOperators = (0, _useOnOperators.default)(jqlSearchableFields$);
  var onFunctions = (0, _useOnFunctions.default)(jqlSearchableFields$, jqlFunctions$);
  var onValues = (0, _useOnValues.default)(jqlSearchableFields$, getSuggestions, createAndFireAnalyticsEvent);
  (0, _react.useEffect)(function () {
    // Load autocomplete data on mount
    load(getInitialData, createAndFireAnalyticsEvent);
  }, [createAndFireAnalyticsEvent, getInitialData, load]);
  return (0, _react.useMemo)(function () {
    return {
      onFields: onFields,
      onOperators: onOperators,
      onFunctions: onFunctions,
      onValues: onValues
    };
  }, [onFields, onOperators, onFunctions, onValues]);
};