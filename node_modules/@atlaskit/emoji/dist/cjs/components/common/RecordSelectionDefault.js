"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createRecordSelectionDefault = void 0;
var _analytics = require("../../util/analytics");
var _analytics2 = require("../../util/analytics/analytics");
/**
 * A function that will wrap any configured Emoji 'onSelection' function to ensure recordSelection is always
 * called.
 *
 * @param provider the EmojiProvider which will be called on each emoji selection
 * @param onSelect the onSelect function that is explicitly configured on the Emoji component.
 * @param fireAnalytics a function used to fire analytics events.
 */
var createRecordSelectionDefault = exports.createRecordSelectionDefault = function createRecordSelectionDefault(provider, onSelect, fireAnalytics) {
  return function (emojiId, emoji, event) {
    try {
      if (provider.recordSelection && emoji) {
        _analytics.ufoExperiences['emoji-selection-recorded'].start();
        provider.recordSelection(emoji).then(function () {
          fireAnalytics && fireAnalytics((0, _analytics.recordSucceededEmoji)(emoji));
          _analytics.ufoExperiences['emoji-selection-recorded'].success();
        }).catch(function (error) {
          fireAnalytics && fireAnalytics((0, _analytics.recordFailedEmoji)(emoji));
          _analytics.ufoExperiences['emoji-selection-recorded'].failure({
            metadata: {
              error: (0, _analytics2.extractErrorInfo)(error),
              reason: 'recordSelection error',
              source: 'RecordSelectionDefault',
              emojiId: emoji.id
            }
          });
        });
      }
    } finally {
      if (onSelect) {
        onSelect(emojiId, emoji, event);
      }
    }
  };
};