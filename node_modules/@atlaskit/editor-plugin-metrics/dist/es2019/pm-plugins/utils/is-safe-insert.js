import { ReplaceStep } from '@atlaskit/editor-prosemirror/transform';
export const isSafeInsert = (tr, insertPos, trType) => {
  var _$firstStepPos$node, _$insertPos$node;
  // Exclude the cases where trType is defined, as it is a specific action
  // that should not be considered for safe insert actions
  if (trType) {
    return false;
  }
  if (insertPos > tr.doc.content.size) {
    return false;
  }
  const [firstStep] = tr.steps;
  if (!(firstStep instanceof ReplaceStep)) {
    return false;
  }
  const firstStepPos = firstStep.from;
  if (firstStepPos === insertPos) {
    return false;
  }
  const $firstStepPos = tr.doc.resolve(firstStepPos);
  if ($firstStepPos.node().type.name === 'paragraph') {
    return false;
  }
  const firstStepParentNodeType = (_$firstStepPos$node = $firstStepPos.node($firstStepPos.depth)) === null || _$firstStepPos$node === void 0 ? void 0 : _$firstStepPos$node.type.name;
  const $insertPos = tr.doc.resolve(insertPos);
  const parentNodeType = (_$insertPos$node = $insertPos.node($insertPos.depth - 1)) === null || _$insertPos$node === void 0 ? void 0 : _$insertPos$node.type.name;
  return parentNodeType !== firstStepParentNodeType;
};