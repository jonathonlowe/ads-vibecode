import { find } from '@atlaskit/editor-common/quick-insert';
import { dedupe } from '@atlaskit/editor-common/utils';
import { fg } from '@atlaskit/platform-feature-flags';
export const getQuickInsertSuggestions = (searchOptions, lazyDefaultItems = () => [], providedItems) => {
  // @ts-ignore
  const {
    query,
    category,
    disableDefaultItems,
    featuredItems,
    prioritySortingFn
  } = searchOptions;
  const defaultItems = disableDefaultItems ? [] : lazyDefaultItems();
  const dedupeFn = fg('platform_editor_quick_insert_dedupe_title_desc') ? item => {
    var _item$description;
    return `${item.title}-${(_item$description = item.description) !== null && _item$description !== void 0 ? _item$description : ''}`;
  } : item => item.title;
  const items = providedItems ? dedupe([...defaultItems, ...providedItems], dedupeFn) : defaultItems;
  if (featuredItems) {
    return items.filter(item => item.featured);
  }
  return find(query || '', category === 'all' || !category ? items : items.filter(item => item.categories && item.categories.includes(category)), prioritySortingFn);
};