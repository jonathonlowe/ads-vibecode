"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.cellAround = cellAround;
exports.cellNear = cellNear;
exports.nextCell = nextCell;
exports.pointsAtCell = pointsAtCell;
var _tableMap = require("../table-map");
function pointsAtCell($pos) {
  return $pos.parent.type.spec.tableRole === 'row' && $pos.nodeAfter;
}
function cellNear($pos) {
  for (var after = $pos.nodeAfter, pos = $pos.pos; after; after = after.firstChild, pos++) {
    var role = after.type.spec.tableRole;
    if (role === 'cell' || role === 'header_cell') {
      return $pos.doc.resolve(pos);
    }
  }
  for (var before = $pos.nodeBefore, _pos = $pos.pos; before; before = before.lastChild, _pos--) {
    var _role = before.type.spec.tableRole;
    if (_role === 'cell' || _role === 'header_cell') {
      return $pos.doc.resolve(_pos - before.nodeSize);
    }
  }
  return null;
}
function cellAround($pos) {
  for (var d = $pos.depth - 1; d > 0; d--) {
    if ($pos.node(d).type.spec.tableRole === 'row') {
      return $pos.node(0).resolve($pos.before(d + 1));
    }
  }
  return null;
}
function nextCell($pos, axis, dir) {
  var start = $pos.start(-1);
  var map = _tableMap.TableMap.get($pos.node(-1));
  var moved = map.nextCell($pos.pos - start, axis, dir);
  return moved == null ? null : $pos.node(0).resolve(start + moved);
}