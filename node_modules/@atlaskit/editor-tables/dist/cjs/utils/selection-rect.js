"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.selectedRect = selectedRect;
var _cellSelection = require("../cell-selection");
var _tableMap = require("../table-map");
var _selectionCell = require("./selection-cell");
// Helper to get the selected rectangle in a table, if any. Adds table
// map, table node, and table start offset to the object for
// convenience.
function selectedRect(state) {
  var sel = state.selection;
  var $pos = (0, _selectionCell.selectionCell)(sel);
  if (!$pos) {
    throw new Error("selectedRect: invalid $pos for selection");
  }
  var table = $pos.node(-1);
  var tableStart = $pos.start(-1);
  var map = _tableMap.TableMap.get(table);
  var rect;
  if (sel instanceof _cellSelection.CellSelection) {
    rect = map.rectBetween(sel.$anchorCell.pos - tableStart, sel.$headCell.pos - tableStart);
  } else {
    rect = map.findCell($pos.pos - tableStart);
  }
  rect.tableStart = tableStart;
  rect.map = map;
  rect.table = table;
  return rect;
}