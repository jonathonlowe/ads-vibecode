/* eslint-disable @atlaskit/editor/no-re-export */
// Entry file in package.json

import { Selection } from '@atlaskit/editor-prosemirror/state';
import { inSameTable } from './utils/tables';
export class CellBookmark {
  constructor(anchor, head) {
    this.anchor = anchor;
    this.head = head;
  }
  map(mapping) {
    return new CellBookmark(mapping.map(this.anchor), mapping.map(this.head));
  }
  resolve(doc) {
    const $anchorCell = doc.resolve(this.anchor);
    const $headCell = doc.resolve(this.head);
    if ($anchorCell.parent.type.spec.tableRole === 'row' && $headCell.parent.type.spec.tableRole === 'row' && $anchorCell.index() < $anchorCell.parent.childCount && $headCell.index() < $headCell.parent.childCount && inSameTable($anchorCell, $headCell)) {
      const data = {
        type: 'cell',
        anchor: $anchorCell.pos,
        head: $headCell.pos
      };
      return Selection.fromJSON(doc, data);
    }
    return Selection.near($headCell, 1);
  }
}