import { TableMap } from '../table-map';
import { findTable } from './find';

// Returns an array of all cells in a table.
export var getCellsInTable = function getCellsInTable(selection) {
  var table = findTable(selection);
  if (!table) {
    return;
  }
  var map = TableMap.get(table.node);
  var positions = map.cellsInRect({
    left: 0,
    right: map.width,
    top: 0,
    bottom: map.height
  });
  return positions.map(function (cellPos) {
    var node = table.node.nodeAt(cellPos);
    if (node) {
      var pos = cellPos + table.start;
      return {
        pos: pos,
        start: pos + 1,
        node: node,
        depth: table.depth + 2
      };
    }
  }).filter(function (cell) {
    return typeof cell !== 'undefined';
  });
};