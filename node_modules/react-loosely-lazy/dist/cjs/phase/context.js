"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useLazyPhase = exports.setCurrent = exports.LazyPhaseContext = void 0;
var _react = require("react");
var _constants = require("../constants");
var _listeners = require("./listeners");
var _utils = require("./utils");
let CURRENT_PHASE = _constants.PHASE.PAINT;
const setCurrent = phase => {
  CURRENT_PHASE = phase;
  _listeners.LISTENERS.slice(0).forEach(listener => listener(phase));
};
exports.setCurrent = setCurrent;
const LazyPhaseContext = exports.LazyPhaseContext = /*#__PURE__*/(0, _react.createContext)({
  subscribe: (0, _utils.createSubscribe)(_listeners.LISTENERS),
  currentValue: () => CURRENT_PHASE,
  api: {
    startNextPhase: () => {
      setCurrent(_constants.PHASE.AFTER_PAINT);
    },
    resetPhase: () => setCurrent(_constants.PHASE.PAINT)
  }
});
const useLazyPhase = () => {
  const v = (0, _react.useContext)(LazyPhaseContext);
  return v.api;
};
exports.useLazyPhase = useLazyPhase;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX2NvbnN0YW50cyIsIl9saXN0ZW5lcnMiLCJfdXRpbHMiLCJDVVJSRU5UX1BIQVNFIiwiUEhBU0UiLCJQQUlOVCIsInNldEN1cnJlbnQiLCJwaGFzZSIsIkxJU1RFTkVSUyIsInNsaWNlIiwiZm9yRWFjaCIsImxpc3RlbmVyIiwiZXhwb3J0cyIsIkxhenlQaGFzZUNvbnRleHQiLCJjcmVhdGVDb250ZXh0Iiwic3Vic2NyaWJlIiwiY3JlYXRlU3Vic2NyaWJlIiwiY3VycmVudFZhbHVlIiwiYXBpIiwic3RhcnROZXh0UGhhc2UiLCJBRlRFUl9QQUlOVCIsInJlc2V0UGhhc2UiLCJ1c2VMYXp5UGhhc2UiLCJ2IiwidXNlQ29udGV4dCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9waGFzZS9jb250ZXh0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDb250ZXh0LCB1c2VDb250ZXh0IH0gZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgeyBQSEFTRSB9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQgdHlwZSB7IFN1YnNjcmlwdGlvbkNvbnRleHRWYWx1ZSB9IGZyb20gJy4uL2xhenkvdHlwZXMnO1xuXG5pbXBvcnQgeyBMSVNURU5FUlMgfSBmcm9tICcuL2xpc3RlbmVycyc7XG5pbXBvcnQgdHlwZSB7IExpc3RlbmVyIH0gZnJvbSAnLi9saXN0ZW5lcnMnO1xuaW1wb3J0IHsgY3JlYXRlU3Vic2NyaWJlIH0gZnJvbSAnLi91dGlscyc7XG5cbmxldCBDVVJSRU5UX1BIQVNFID0gUEhBU0UuUEFJTlQ7XG5cbmV4cG9ydCBjb25zdCBzZXRDdXJyZW50ID0gKHBoYXNlOiBudW1iZXIpID0+IHtcbiAgQ1VSUkVOVF9QSEFTRSA9IHBoYXNlO1xuICBMSVNURU5FUlMuc2xpY2UoMCkuZm9yRWFjaCgobGlzdGVuZXI6IExpc3RlbmVyKSA9PiBsaXN0ZW5lcihwaGFzZSkpO1xufTtcblxuaW50ZXJmYWNlIExhenlQaGFzZUNvbnRleHRBcGkgZXh0ZW5kcyBTdWJzY3JpcHRpb25Db250ZXh0VmFsdWUge1xuICBhcGk6IHtcbiAgICBzdGFydE5leHRQaGFzZTogKCkgPT4gdm9pZDtcbiAgICByZXNldFBoYXNlOiAoKSA9PiB2b2lkO1xuICB9O1xufVxuXG5leHBvcnQgY29uc3QgTGF6eVBoYXNlQ29udGV4dCA9IGNyZWF0ZUNvbnRleHQ8TGF6eVBoYXNlQ29udGV4dEFwaT4oe1xuICBzdWJzY3JpYmU6IGNyZWF0ZVN1YnNjcmliZShMSVNURU5FUlMpLFxuICBjdXJyZW50VmFsdWU6ICgpID0+IENVUlJFTlRfUEhBU0UsXG4gIGFwaToge1xuICAgIHN0YXJ0TmV4dFBoYXNlOiAoKSA9PiB7XG4gICAgICBzZXRDdXJyZW50KFBIQVNFLkFGVEVSX1BBSU5UKTtcbiAgICB9LFxuICAgIHJlc2V0UGhhc2U6ICgpID0+IHNldEN1cnJlbnQoUEhBU0UuUEFJTlQpLFxuICB9LFxufSk7XG5cbmV4cG9ydCBjb25zdCB1c2VMYXp5UGhhc2UgPSAoKSA9PiB7XG4gIGNvbnN0IHYgPSB1c2VDb250ZXh0KExhenlQaGFzZUNvbnRleHQpO1xuXG4gIHJldHVybiB2LmFwaTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLE1BQUEsR0FBQUMsT0FBQTtBQUVBLElBQUFDLFVBQUEsR0FBQUQsT0FBQTtBQUdBLElBQUFFLFVBQUEsR0FBQUYsT0FBQTtBQUVBLElBQUFHLE1BQUEsR0FBQUgsT0FBQTtBQUVBLElBQUlJLGFBQWEsR0FBR0MsZ0JBQUssQ0FBQ0MsS0FBSztBQUV4QixNQUFNQyxVQUFVLEdBQUlDLEtBQWEsSUFBSztFQUMzQ0osYUFBYSxHQUFHSSxLQUFLO0VBQ3JCQyxvQkFBUyxDQUFDQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUNDLE9BQU8sQ0FBRUMsUUFBa0IsSUFBS0EsUUFBUSxDQUFDSixLQUFLLENBQUMsQ0FBQztBQUNyRSxDQUFDO0FBQUNLLE9BQUEsQ0FBQU4sVUFBQSxHQUFBQSxVQUFBO0FBU0ssTUFBTU8sZ0JBQWdCLEdBQUFELE9BQUEsQ0FBQUMsZ0JBQUEsZ0JBQUcsSUFBQUMsb0JBQWEsRUFBc0I7RUFDakVDLFNBQVMsRUFBRSxJQUFBQyxzQkFBZSxFQUFDUixvQkFBUyxDQUFDO0VBQ3JDUyxZQUFZLEVBQUVBLENBQUEsS0FBTWQsYUFBYTtFQUNqQ2UsR0FBRyxFQUFFO0lBQ0hDLGNBQWMsRUFBRUEsQ0FBQSxLQUFNO01BQ3BCYixVQUFVLENBQUNGLGdCQUFLLENBQUNnQixXQUFXLENBQUM7SUFDL0IsQ0FBQztJQUNEQyxVQUFVLEVBQUVBLENBQUEsS0FBTWYsVUFBVSxDQUFDRixnQkFBSyxDQUFDQyxLQUFLO0VBQzFDO0FBQ0YsQ0FBQyxDQUFDO0FBRUssTUFBTWlCLFlBQVksR0FBR0EsQ0FBQSxLQUFNO0VBQ2hDLE1BQU1DLENBQUMsR0FBRyxJQUFBQyxpQkFBVSxFQUFDWCxnQkFBZ0IsQ0FBQztFQUV0QyxPQUFPVSxDQUFDLENBQUNMLEdBQUc7QUFDZCxDQUFDO0FBQUNOLE9BQUEsQ0FBQVUsWUFBQSxHQUFBQSxZQUFBIiwiaWdub3JlTGlzdCI6W119