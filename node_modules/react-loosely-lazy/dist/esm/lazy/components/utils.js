import { useContext, useMemo } from 'react';
export function useSubscription({
  context,
  load,
  onValue
}) {
  const {
    subscribe,
    currentValue
  } = useContext(context);
  useMemo(() => {
    let unsubscribe = null;
    const check = () => {
      const done = onValue(currentValue());
      if (done) load();
      if (done && unsubscribe) unsubscribe();
      return done;
    };
    unsubscribe = !check() ? subscribe(check) : null;
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, []);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ1c2VDb250ZXh0IiwidXNlTWVtbyIsInVzZVN1YnNjcmlwdGlvbiIsImNvbnRleHQiLCJsb2FkIiwib25WYWx1ZSIsInN1YnNjcmliZSIsImN1cnJlbnRWYWx1ZSIsInVuc3Vic2NyaWJlIiwiY2hlY2siLCJkb25lIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xhenkvY29tcG9uZW50cy91dGlscy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VDb250ZXh0LCB1c2VNZW1vIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHR5cGUgeyBDb250ZXh0IH0gZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgdHlwZSB7IFN1YnNjcmlwdGlvbkNvbnRleHRWYWx1ZSB9IGZyb20gJy4uL3R5cGVzJztcblxudHlwZSBVc2VTdWJzY3JpcHRpb25BcmdzPEM+ID0ge1xuICBjb250ZXh0OiBDb250ZXh0PEM+O1xuICBsb2FkOiAoKSA9PiB2b2lkO1xuICBvblZhbHVlOiAodjogbnVtYmVyKSA9PiBib29sZWFuO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZVN1YnNjcmlwdGlvbjxDIGV4dGVuZHMgU3Vic2NyaXB0aW9uQ29udGV4dFZhbHVlPih7XG4gIGNvbnRleHQsXG4gIGxvYWQsXG4gIG9uVmFsdWUsXG59OiBVc2VTdWJzY3JpcHRpb25BcmdzPEM+KSB7XG4gIGNvbnN0IHsgc3Vic2NyaWJlLCBjdXJyZW50VmFsdWUgfSA9IHVzZUNvbnRleHQoY29udGV4dCk7XG4gIHVzZU1lbW8oKCkgPT4ge1xuICAgIGxldCB1bnN1YnNjcmliZTogKCgpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XG4gICAgY29uc3QgY2hlY2sgPSAoKSA9PiB7XG4gICAgICBjb25zdCBkb25lID0gb25WYWx1ZShjdXJyZW50VmFsdWUoKSk7XG4gICAgICBpZiAoZG9uZSkgbG9hZCgpO1xuICAgICAgaWYgKGRvbmUgJiYgdW5zdWJzY3JpYmUpIHVuc3Vic2NyaWJlKCk7XG5cbiAgICAgIHJldHVybiBkb25lO1xuICAgIH07XG5cbiAgICB1bnN1YnNjcmliZSA9ICFjaGVjaygpID8gc3Vic2NyaWJlKGNoZWNrKSA6IG51bGw7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuICB9LCBbXSk7XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLFVBQVUsRUFBRUMsT0FBTyxRQUFRLE9BQU87QUFXM0MsT0FBTyxTQUFTQyxlQUFlQSxDQUFxQztFQUNsRUMsT0FBTztFQUNQQyxJQUFJO0VBQ0pDO0FBQ3NCLENBQUMsRUFBRTtFQUN6QixNQUFNO0lBQUVDLFNBQVM7SUFBRUM7RUFBYSxDQUFDLEdBQUdQLFVBQVUsQ0FBQ0csT0FBTyxDQUFDO0VBQ3ZERixPQUFPLENBQUMsTUFBTTtJQUNaLElBQUlPLFdBQWdDLEdBQUcsSUFBSTtJQUMzQyxNQUFNQyxLQUFLLEdBQUdBLENBQUEsS0FBTTtNQUNsQixNQUFNQyxJQUFJLEdBQUdMLE9BQU8sQ0FBQ0UsWUFBWSxDQUFDLENBQUMsQ0FBQztNQUNwQyxJQUFJRyxJQUFJLEVBQUVOLElBQUksQ0FBQyxDQUFDO01BQ2hCLElBQUlNLElBQUksSUFBSUYsV0FBVyxFQUFFQSxXQUFXLENBQUMsQ0FBQztNQUV0QyxPQUFPRSxJQUFJO0lBQ2IsQ0FBQztJQUVERixXQUFXLEdBQUcsQ0FBQ0MsS0FBSyxDQUFDLENBQUMsR0FBR0gsU0FBUyxDQUFDRyxLQUFLLENBQUMsR0FBRyxJQUFJO0lBQ2hEO0VBQ0YsQ0FBQyxFQUFFLEVBQUUsQ0FBQztBQUNSIiwiaWdub3JlTGlzdCI6W119