import { getConfig, MODE } from '../config';
import { COLLECTED } from '../constants';
import { cloneElements } from './render';
import { refElements } from './hydrate';
export const collect = () => {
  const markers = document.querySelectorAll('input[data-lazy-begin]');
  const {
    mode
  } = getConfig();
  for (let i = 0, j = markers.length; i < j; i += 1) {
    const el = markers[i];
    const {
      lazyBegin
    } = el.dataset || {};
    const value = mode === MODE.RENDER ? cloneElements(markers[i], lazyBegin) : refElements(markers[i], lazyBegin);
    if (COLLECTED.has(lazyBegin)) {
      COLLECTED.get(lazyBegin).push(value);
    } else {
      COLLECTED.set(lazyBegin, [value]);
    }
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZXRDb25maWciLCJNT0RFIiwiQ09MTEVDVEVEIiwiY2xvbmVFbGVtZW50cyIsInJlZkVsZW1lbnRzIiwiY29sbGVjdCIsIm1hcmtlcnMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJtb2RlIiwiaSIsImoiLCJsZW5ndGgiLCJlbCIsImxhenlCZWdpbiIsImRhdGFzZXQiLCJ2YWx1ZSIsIlJFTkRFUiIsImhhcyIsImdldCIsInB1c2giLCJzZXQiXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29sbGVjdC9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRDb25maWcsIE1PREUgfSBmcm9tICcuLi9jb25maWcnO1xuaW1wb3J0IHsgQ09MTEVDVEVEIH0gZnJvbSAnLi4vY29uc3RhbnRzJztcblxuaW1wb3J0IHsgY2xvbmVFbGVtZW50cyB9IGZyb20gJy4vcmVuZGVyJztcbmltcG9ydCB7IHJlZkVsZW1lbnRzIH0gZnJvbSAnLi9oeWRyYXRlJztcblxuZXhwb3J0IGNvbnN0IGNvbGxlY3QgPSAoKSA9PiB7XG4gIGNvbnN0IG1hcmtlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsPEhUTUxJbnB1dEVsZW1lbnQ+KFxuICAgICdpbnB1dFtkYXRhLWxhenktYmVnaW5dJ1xuICApO1xuICBjb25zdCB7IG1vZGUgfSA9IGdldENvbmZpZygpO1xuICBmb3IgKGxldCBpID0gMCwgaiA9IG1hcmtlcnMubGVuZ3RoOyBpIDwgajsgaSArPSAxKSB7XG4gICAgY29uc3QgZWwgPSBtYXJrZXJzW2ldO1xuICAgIGNvbnN0IHsgbGF6eUJlZ2luIH0gPSBlbC5kYXRhc2V0IHx8IHt9O1xuICAgIGNvbnN0IHZhbHVlID1cbiAgICAgIG1vZGUgPT09IE1PREUuUkVOREVSXG4gICAgICAgID8gY2xvbmVFbGVtZW50cyhtYXJrZXJzW2ldLCBsYXp5QmVnaW4pXG4gICAgICAgIDogcmVmRWxlbWVudHMobWFya2Vyc1tpXSwgbGF6eUJlZ2luKTtcblxuICAgIGlmIChDT0xMRUNURUQuaGFzKGxhenlCZWdpbikpIHtcbiAgICAgIENPTExFQ1RFRC5nZXQobGF6eUJlZ2luKS5wdXNoKHZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgQ09MTEVDVEVELnNldChsYXp5QmVnaW4sIFt2YWx1ZV0pO1xuICAgIH1cbiAgfVxufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsU0FBUyxFQUFFQyxJQUFJLFFBQVEsV0FBVztBQUMzQyxTQUFTQyxTQUFTLFFBQVEsY0FBYztBQUV4QyxTQUFTQyxhQUFhLFFBQVEsVUFBVTtBQUN4QyxTQUFTQyxXQUFXLFFBQVEsV0FBVztBQUV2QyxPQUFPLE1BQU1DLE9BQU8sR0FBR0EsQ0FBQSxLQUFNO0VBQzNCLE1BQU1DLE9BQU8sR0FBR0MsUUFBUSxDQUFDQyxnQkFBZ0IsQ0FDdkMsd0JBQ0YsQ0FBQztFQUNELE1BQU07SUFBRUM7RUFBSyxDQUFDLEdBQUdULFNBQVMsQ0FBQyxDQUFDO0VBQzVCLEtBQUssSUFBSVUsQ0FBQyxHQUFHLENBQUMsRUFBRUMsQ0FBQyxHQUFHTCxPQUFPLENBQUNNLE1BQU0sRUFBRUYsQ0FBQyxHQUFHQyxDQUFDLEVBQUVELENBQUMsSUFBSSxDQUFDLEVBQUU7SUFDakQsTUFBTUcsRUFBRSxHQUFHUCxPQUFPLENBQUNJLENBQUMsQ0FBQztJQUNyQixNQUFNO01BQUVJO0lBQVUsQ0FBQyxHQUFHRCxFQUFFLENBQUNFLE9BQU8sSUFBSSxDQUFDLENBQUM7SUFDdEMsTUFBTUMsS0FBSyxHQUNUUCxJQUFJLEtBQUtSLElBQUksQ0FBQ2dCLE1BQU0sR0FDaEJkLGFBQWEsQ0FBQ0csT0FBTyxDQUFDSSxDQUFDLENBQUMsRUFBRUksU0FBUyxDQUFDLEdBQ3BDVixXQUFXLENBQUNFLE9BQU8sQ0FBQ0ksQ0FBQyxDQUFDLEVBQUVJLFNBQVMsQ0FBQztJQUV4QyxJQUFJWixTQUFTLENBQUNnQixHQUFHLENBQUNKLFNBQVMsQ0FBQyxFQUFFO01BQzVCWixTQUFTLENBQUNpQixHQUFHLENBQUNMLFNBQVMsQ0FBQyxDQUFDTSxJQUFJLENBQUNKLEtBQUssQ0FBQztJQUN0QyxDQUFDLE1BQU07TUFDTGQsU0FBUyxDQUFDbUIsR0FBRyxDQUFDUCxTQUFTLEVBQUUsQ0FBQ0UsS0FBSyxDQUFDLENBQUM7SUFDbkM7RUFDRjtBQUNGLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=